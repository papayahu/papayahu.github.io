<html>
<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>cali.so部署教程（補充） | 湛藍</title>

<link rel="shortcut icon" href="https://papayahu.github.io/favicon.ico?v=1735539373663">

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="/styles/main.css">

<style>
    hr {
        margin-top: 1rem;
        margin-bottom: 1rem;
        border: 0;
        border-top: 1px solid rgba(0, 0, 0, 0.1);
    }
</style>
<script src="/media/scripts/highlight.min.js"></script>
<script src="/media/scripts/dockerfile.min.js"></script>
<script src="/media/scripts/dart.min.js"></script>


<script defer type="text/javascript" src="/js/mouse.js"></script>
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<script defer type="text/javascript" src="https://papayahu.github.io/js/console-text.js"></script>
<canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:99999999;pointer-events:none;"> </canvas>
<script type="text/javascript" src="/media/scripts/anime.min.js"></script>
<script type="text/javascript" src="/media/scripts/fireworks.js"></script>
<script src="media/scripts/search.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <script src="/media/scripts/aplayer/APlayer.min.js"></script>
<link rel="stylesheet" href="/media/scripts/aplayer/APlayer.min.css">
<div id="aplayer" class="aplayer"  data-id="6975606533&amp;userid=3272805836" data-server="netease" data-type="playlist" data-fixed="true" data-listfolded="true" data-order="random" data-theme="#F58EA8"></div>
<script src="/media/scripts/jquery-ui.js"></script>
<script src="/media/scripts/jquery-ui.min.js"></script>

<script src="/media/scripts/time_add.js"></script></br>
<style>
    /* 导航栏样式 */
    .navbar {
        position: relative;
        display: -ms-flexbox;
        display: flex;
        -ms-flex-wrap: wrap;
        flex-wrap: wrap;
        -ms-flex-align: center;
        align-items: center;
        -ms-flex-pack: justify;
        justify-content: space-between;
        padding: 0.5rem 1rem;
    }

    .navbar-brand {
        display: inline-block;
        padding-top: 0.3125rem;
        padding-bottom: 0.3125rem;
        margin-right: 1rem;
        font-size: 1.25rem;
        line-height: inherit;
        white-space: nowrap;
    }

    .navbar-brand:hover,
    .navbar-brand:focus {
        text-decoration: none;
    }

    .navbar-nav {
        display: -ms-flexbox;
        display: flex;
        -ms-flex-direction: column;
        flex-direction: column;
        padding-left: 0;
        margin-bottom: 0;
        list-style: none;
    }

    .navbar-collapse {
        -ms-flex-preferred-size: 100%;
        flex-basis: 100%;
        -ms-flex-positive: 1;
        flex-grow: 1;
        -ms-flex-align: center;
        align-items: center;
    }

    .navbar-toggler {
        padding: 0.25rem 0.75rem;
        font-size: 1.25rem;
        line-height: 1;
        background-color: transparent;
        border: 1px solid transparent;
        border-radius: 0.25rem;
    }

    .navbar-toggler:hover,
    .navbar-toggler:focus {
        text-decoration: none;
    }

    @media (min-width: 992px) {
        .navbar-expand-lg {
            -ms-flex-flow: row nowrap;
            flex-flow: row nowrap;
            -ms-flex-pack: start;
            justify-content: flex-start;
        }

        .navbar-expand-lg .navbar-nav {
            -ms-flex-direction: row;
            flex-direction: row;
        }

        .navbar-expand-lg .navbar-collapse {
            display: -ms-flexbox !important;
            display: flex !important;
            -ms-flex-preferred-size: auto;
            flex-basis: auto;
        }

        .navbar-expand-lg .navbar-toggler {
            display: none;
        }
    }

    @media (max-width: 991px) {
        #navbarSupportedContent {
            display: none;
        }
    }
</style>

<!-- <button id="myImg">分享出去</button> -->

<script src="/media/scripts/jquery-3.5.1.min.js"></script>
<script src="/media/scripts/jquery-ui.js"></script>
<script src="/media/scripts/jquery-ui.min.js"></script>
<script src="/media/scripts/index.js"></script>


<link rel="stylesheet" href="/media/script/jquery-ui.min.css">

<nav class="navbar navbar-expand-lg">
    <div class="navbar-brand"  id="myImg" title="點我分享出去哦~">
        <img class="user-avatar" src="/images/avatar.png" alt="頭像">
        <div class="site-name gt-c-content-color-first">
            湛藍
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" id="right_list">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>

    <div class="list_menu">
    <div class="list_right">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
            <div class="nav-item">
                
                <a href="/" class="menu gt-a-link">
                    首頁
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/archives" class="menu gt-a-link">
                    歸檔
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/tags" class="menu gt-a-link">
                    標籤
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/post/about" class="menu gt-a-link">
                    關於
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/post/music" class="menu gt-a-link">
                    樂廊
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="https://papayahu.github.io/memos/" class="menu gt-a-link" target="_blank">
                    隨記
                </a>
                
            </div>
            
        </div>
    </div>
    </div>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
            <div class="nav-item">
                
                <a href="/" class="menu gt-a-link">
                    首頁
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/archives" class="menu gt-a-link">
                    歸檔
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/tags" class="menu gt-a-link">
                    標籤
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/post/about" class="menu gt-a-link">
                    關於
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/post/music" class="menu gt-a-link">
                    樂廊
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="https://papayahu.github.io/memos/" class="menu gt-a-link" target="_blank">
                    隨記
                </a>
                
            </div>
            
        </div>
        <div style="text-align: center">
            <form id="gridea-search-form" style="position: relative" data-update="1735539373663"
                action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜尋文章" />
                <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
        </div>
    </div>
</nav>
<script>
    /* 移动端导航栏展开/收起切换 */
    document.getElementById('changeNavbar').onclick = function () {
        var element = document.getElementById('navbarSupportedContent');
        if (element.style.display === 'none' || element.style.display === '') {
            element.style.display = 'block';
        } else {
            element.style.display = 'none';
        }
    }
</script>
<script type="text/javascript" src="/media/scripts/mouse_text.js"></script>
    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    cali.so部署教程（補充）
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        · 2023-10-15 ·
                    </time>
                    
                </div>
                <div class="post-content">
                    <p>一、影片教學補充<br>
略</p>
<p>二、源碼修改參考</p>
<ol>
<li>更改<code>/admin</code> 顯示語言，到源碼的<code>app/admin/page.tsx</code>、<code>app/admin/comments/page.tsx</code>、<code>app/admin/Sidebar.tsx</code>、<code>sanity/schemas/blockContent.ts</code>、<code>sanity/schemas/category.ts</code>、<code>sanity/schemas/post.ts</code>、<code>sanity/schemas/project.ts</code>、<code>sanity/schemas/settings.ts</code>、<code>app/(main)/Newsletter.tsx</code>、<code>app/api/newsletter/route.ts</code>、<code>app/(main)/Header.tsx</code>、<code>config/nav.ts</code>...修改</li>
<li>在<code>next.config.mjs</code>更改社交連結</li>
<li>在<code>app/(main)/ama/page.tsx</code>更改主頁選單的AMA咨詢內容（todo）</li>
<li>在<code>app/(main)/Footer.tsx</code>更改顯示語言</li>
</ol>
<p>三、原教程文檔部署參考</p>
<ol>
<li>先將 <a href="https://github.com/CaliCastle/cali.so">GitHub repo</a> fork到自己的GitHub帳號裡。<br>
<img src="https://papayahu.github.io/post-images/1697443417297.png" alt="fork" loading="lazy"></li>
<li>點擊右下角 <strong>Create fork</strong>。<br>
<img src="https://papayahu.github.io/post-images/1697443435551.png" alt="repo" loading="lazy"></li>
<li>將剛剛的fork到自己帳號的repo的URL複製下來備用。<br>
<img src="https://papayahu.github.io/post-images/1697443449735.png" alt="copy" loading="lazy"></li>
<li>下載並安裝 <a href="https://git-scm.com/downloads">git</a> ,可參考 <a href="https://progressbar.tw/posts/1">git安裝教程</a></li>
<li>將它藉由git clone的方式複製到電腦本地資料夾中。（要使用Shift+Insert貼上URL）(git的複製及貼上的快捷鍵為Ctrl/Shift+Insert)<br>
<img src="https://papayahu.github.io/post-images/1697443467221.png" alt="git" loading="lazy"> 輸入<code>git clone URL</code><br>
<img src="https://papayahu.github.io/post-images/1697443479460.png" alt="clone" loading="lazy"></li>
<li>安裝pnpm。（可參考<a href="https://pnpm.io/installation">pnpm官網安裝</a>或以下方式，若已安裝完畢可直接進入第10步驟）</li>
<li>進去官網安裝 <a href="https://nodejs.org/en">Node.js</a> ，可安裝18.18.2版本（推薦大多數用戶使用）<br>
<img src="https://papayahu.github.io/post-images/1697443499492.png" alt="node" loading="lazy"></li>
<li>點擊<strong>Window+R鍵</strong>，輸入<code>cmd</code>，按下<strong>確定</strong>，進去新視窗。</li>
<li>依照下圖輸入命令，並安裝pnpm（每次輸入完畢要按<strong>Enter</strong>執行命令）。<br>
輸入<code>node -v</code>確認Node.js是否安裝成功；輸入<code>npm -v</code>確認npm是否安裝成功；輸入<code>npm install -g pnpm</code>安裝pnpm；輸入<code>pnpm -v</code>確認pnpm是否安裝成功。<br>
<img src="https://papayahu.github.io/post-images/1697443517340.png" alt="cmd" loading="lazy"></li>
<li>cd到本地目錄 <code>cd C:\workSpace\GitLoadWareHouse\cali.so</code>（可參考第5步驟的附圖之路徑），安裝 node_modules 依賴庫 <code>pnpm i</code>。<br>
<img src="https://papayahu.github.io/post-images/1697443541050.png" alt="pnpm" loading="lazy"></li>
<li>Sanity內容管理，參考 <a href="https://cali.so/blog/guide-for-cloning-my-site#c39ca080a772">左側目錄</a><br>
補充：複製完Project ID後，依照下圖路徑打開.env和.env.example兩個檔案。（可使用Notepad3或別的編輯器開啟，若需下載Notepad3可參考 <a href="https://notepad3.en.softonic.com/">Notepad3下載</a>）<br>
<img src="https://papayahu.github.io/post-images/1697444081046.png" alt="env" loading="lazy"><br>
<img src="https://papayahu.github.io/post-images/1697444129875.png" alt="example" loading="lazy"><br>
<img src="https://papayahu.github.io/post-images/1697444239798.png" alt="open" loading="lazy"><br>
<strong>.env.example</strong>為參考檔，在此檔填完數值需再複製到.env內</li>
<li>Clerk用戶鑒權，參考 <a href="https://cali.so/blog/guide-for-cloning-my-site#a4eb7b73f9e6">左側目錄</a></li>
<li>PlanetScale 數據庫，參考 <a href="https://cali.so/blog/guide-for-cloning-my-site#937e7eb55360">左側目錄</a> 。此配置須綁卡，也可換成別的不須綁卡的配置，可參考 <a href="https://neon.tech/">Neon</a> 或 <a href="https://turso.tech/">Turso</a></li>
<li>若使用Neon，可找到<strong>Prisma</strong>，複製 <strong>DATABASE_URL</strong><br>
<img src="https://papayahu.github.io/post-images/1697547477215.png" alt="prisma" loading="lazy"></li>
<li>找到<strong>Node.js</strong>，複製<strong>DATABASE_HOST</strong>、<strong>DATABASE_PASSWORD</strong>、<strong>DATABASE_USERNAME</strong><br>
<img src="https://papayahu.github.io/post-images/1697447091225.png" alt="host" loading="lazy"></li>
</ol>

                </div>
            </article>
        </div>

        

        

        
            

            
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs/dist/disqusjs.css">
<script src="https://cdn.jsdelivr.net/npm/disqusjs/dist/disqus.js"></script>

<div id="disqus_thread"></div>

<script>

var options = {
  shortname: 'papayahu',
  apikey: 'NSAcjsZ7RCAIOog4p6CWOM1WFT3GHecymNXvheLRHVduyjTH3dwEfLaJ4649Bv44',
}
if ('https://disqus.skk.moe/disqus') {
  options.api = 'https://disqus.skk.moe/disqus'
}
var dsqjs = new DisqusJS(options)

</script>

            
        

        

        <!-- disqus評論 添加-->
<center><div id="disqus_thread"></div></center>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://papayahu.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!-- disqus評論 添加結束 -->
<div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first">一些記錄和隨筆 | 練習用文字點綴生命</div>
    <div class="social-container">
        
            
                <a href="https://github.com/papayahu" target="_blank">
                    <i class="fab fa-github gt-c-content-color-first"></i>
                </a>
            
        
            
                <a href="https://music.163.com/#/user/home?id=3272805836" target="_blank">
                    <i class="fab fa-netease gt-c-content-color-first"></i>
                </a>
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <script src="/media/scripts/des.js"></script></br>
    <h4 id="sitetime"></h4></br>
    <div class="footer-info">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_uv" style='display:none'>總訪客人數量<span id="busuanzi_value_site_uv"></span>次</span>
	<span id="busuanzi_container_site_pv" style='display:none'>本站總訪問量<span id="busuanzi_value_site_pv"></span>次</span> | 
Theme by <a href="https://www.minloha.cn" target="_blank">Minloha</a>, Powered by <a
                href="https://github.com" target="_blank">Gridea</a>
    </div>
    <!-- 浮动搜索图标 -->
<div class="search-icon" onclick="toggleSearch()">
    <img src="images/magnifying-glass-solid.png" alt="Search">
</div>

<!-- 搜索栏 -->
<div class="search-container" id="search-container" style="display: none;">
    <form method="get" action="https://duckduckgo.com/" class="search-form" role="search">
        <input type="hidden" name="sites" value="https://papayahu.github.io/">
        <input type="search" name="q" id="search-input" placeholder="Search..." autocomplete="off" required>
        <button type="submit">Search</button>
    </form>
</div>
    <!-- 回到頂部按鈕 -->
    <div id="goTopBtn"><span class="glyphicon glyphicon-chevron-up">&Delta;</span></div>
    <div>
<div id="myModal" class="modal">
  <span class="close" onclick="document.getElementById('myModal').style.display='none'">&times;</span>
  <img class="modal-content" id="img01">
  <div id="caption"></div>
</div>
        Copyright © 2023-2024 papayahu. All rights reserved.
    </div>
</div>
<script src="/media/scripts/Meting.min.js"></script>
<script src="/media/scripts/dialog.js"></script>
<script>
  hljs.initHighlightingOnLoad()
</script>

<!-- 复制提醒开始 -->
<link rel="stylesheet" href="https://cdn.bootcss.com/sweetalert/1.1.3/sweetalert.min.css" />
<script type="text/javascript" src="https://cdn.bootcss.com/sweetalert/1.1.3/sweetalert.min.js"></script>

<script>
    document.body.oncopy = function() {
        swal("複製成功！", "若要轉載請保留原文連結，感謝支持！", "success");
    };
</script>
<!-- 复制提醒结束 -->

<script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script>
/*返回顶部*/
$(window).scroll(function(){
   var sc=$(window).scrollTop();
   var rwidth=$(window).width()
   if(sc>0){
    $("#goTopBtn").css("display","block");
    $("#goTopBtn").css("left",(rwidth-36)+"px")
   }else{
   $("#goTopBtn").css("display","none");
   }
 })
 $("#goTopBtn").click(function(){
   var sc=$(window).scrollTop();
   $('body,html').animate({scrollTop:0},500);
 })
   </script>
<!-- 将您的 JavaScript 代码放在这里 -->
<script>
    /* 切换搜索栏的显示/隐藏状态 */
    function toggleSearch() {
        var searchContainer = document.getElementById('search-container');
        var searchIcon = document.querySelector('.search-icon');

        if (searchContainer.style.display === 'none' || searchContainer.style.display === '') {
            searchContainer.style.display = 'block';
            searchIcon.style.display = 'none'; // 隐藏搜索图标
        } else {
            searchContainer.style.display = 'none';
            searchIcon.style.display = 'block'; // 显示搜索图标
        }
    }

    /* 执行搜索后的操作 */
    function executeSearch() {
        // 在这里执行搜索操作，例如跳转到搜索结果页面或者使用 AJAX 加载搜索结果等

        // 搜索完成后，隐藏搜索栏，显示搜索图标
        var searchContainer = document.getElementById('search-container');
        var searchIcon = document.querySelector('.search-icon');
        searchContainer.style.display = 'none';
        searchIcon.style.display = 'block';
    }
</script>
    </div>
</div>
<!-- 将您的 JavaScript 代码放在这里 -->
<script>
    /* 切换搜索栏的显示/隐藏状态 */
    function toggleSearch() {
        var searchContainer = document.getElementById('search-container');
        var searchIcon = document.querySelector('.search-icon');

        if (searchContainer.style.display === 'none' || searchContainer.style.display === '') {
            searchContainer.style.display = 'block';
            searchIcon.style.display = 'none'; // 隐藏搜索图标
        } else {
            searchContainer.style.display = 'none';
            searchIcon.style.display = 'block'; // 显示搜索图标
        }
    }

    /* 执行搜索后的操作 */
    function executeSearch() {
        // 在这里执行搜索操作，例如跳转到搜索结果页面或者使用 AJAX 加载搜索结果等

        // 搜索完成后，隐藏搜索栏，显示搜索图标
        var searchContainer = document.getElementById('search-container');
        var searchIcon = document.querySelector('.search-icon');
        searchContainer.style.display = 'none';
        searchIcon.style.display = 'block';
    }
</script>
</body>
</html>
